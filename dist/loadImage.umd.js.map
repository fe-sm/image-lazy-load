{"version":3,"file":"loadImage.umd.js","sources":["../src/index.js"],"sourcesContent":["  \r\n  // 加载可视区域图片\r\n  // container存在在特定的容器里滚动\r\n  function lazyLoadImg (container, preLoadHeight, delayTime) {\r\n    // 首先获取容器内所有的图片\r\n    var imgList1 = document.querySelectorAll('img')\r\n    var imgs = container ? container.querySelectorAll('img') : imgList1\r\n    var scrollTop = container ? container.scrollTop : document.documentElement.scrollTop\r\n    // 获取屏幕高度\r\n    var nodes = document.querySelectorAll('[data-echo-placeholder]');\r\n    var length = nodes.length;\r\n    var screenHeight = container ? container.offsetHeight : document.documentElement.clientHeight\r\n    // 计算每一张图片是否在可视区域内，若在就给图片增加 data-src 属性\r\n    for (var i = 0; i < imgs.length; i++) {\r\n      var viewTop = imgs[i].offsetTop - scrollTop\r\n      if ( viewTop  < screenHeight + preLoadHeight && viewTop > -imgs[i].offsetHeight) {\r\n        if (imgs[i].getAttribute('data-src') !== null) {\r\n          imgs[i].src = imgs[i].getAttribute('data-src')\r\n          imgs[i].setAttribute('data-echo-placeholder', imgs[i].src);\r\n        }\r\n      }\r\n    }\r\n    // 图片加载结束后移除事件\r\n    if (length >= imgs.length) {\r\n      const element = container ? container : document\r\n      element.removeEventListener('scroll', function() { scroll(container, preLoadHeight, delayTime) })\r\n    }\r\n  }\r\n  var time\r\n  var  timer\r\n  var  data\r\n\r\n  // 给滚动事件增加定时器，当滚动间隔时间少于定时器设置的延迟时间则不加载\r\n  function scroll (container, preLoadHeight, delayTime) {\r\n    // 当滚动不同的页面时，time也进行相应切换\r\n    if (container !== data) {\r\n      times = timer\r\n    } else {\r\n      var t = times\r\n      times = time\r\n      time = t\r\n    }\r\n    data = container\r\n    clearTimeout(times)\r\n    times = setTimeout(function () {\r\n      lazyLoadImg(container, preLoadHeight)\r\n    }, delayTime)\r\n    return times\r\n  }\r\n\r\n  // 滚动时加载图片\r\n  function scrollLoadPic (extraInfo, container = '') {\r\n    var extraInfo = extraInfo || { }\r\n    // 设定的向下多加载的高度\r\n    var preLoadHeight = extraInfo.preLoadHeight || 0\r\n    // 设置的延迟加载时间\r\n    var delayTime = extraInfo.delay || 0\r\n    // 设置的所要加载图片的容器\r\n    var element = container ? container : document\r\n    element.addEventListener('scroll', function() { scroll(container, preLoadHeight, delayTime) },  false)\r\n    scroll(container, preLoadHeight, delayTime)\r\n    clearTimeout(time)\r\n  }\r\n\r\n  export default scrollLoadPic"],"names":["const"],"mappings":";;;;;;;;;;;;;;IAGE,SAAS,WAAW,EAAE,SAAS,EAAE,aAAa,EAAE,SAAS,EAAE;;MAEzD,IAAI,QAAQ,GAAG,QAAQ,CAAC,gBAAgB,CAAC,KAAK,EAAC;MAC/C,IAAI,IAAI,GAAG,SAAS,GAAG,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC,GAAG,SAAQ;MACnE,IAAI,SAAS,GAAG,SAAS,GAAG,SAAS,CAAC,SAAS,GAAG,QAAQ,CAAC,eAAe,CAAC,UAAS;;MAEpF,IAAI,KAAK,GAAG,QAAQ,CAAC,gBAAgB,CAAC,yBAAyB,CAAC,CAAC;MACjE,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;MAC1B,IAAI,YAAY,GAAG,SAAS,GAAG,SAAS,CAAC,YAAY,GAAG,QAAQ,CAAC,eAAe,CAAC,aAAY;;MAE7F,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACpC,IAAI,OAAO,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,UAAS;QAC3C,KAAK,OAAO,IAAI,YAAY,GAAG,aAAa,IAAI,OAAO,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,EAAE;UAC/E,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,UAAU,CAAC,KAAK,IAAI,EAAE;YAC7C,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,UAAU,EAAC;YAC9C,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,uBAAuB,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;WAC5D;SACF;OACF;;MAED,IAAI,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE;QACzBA,IAAM,OAAO,GAAG,SAAS,GAAG,SAAS,GAAG,SAAQ;QAChD,OAAO,CAAC,mBAAmB,CAAC,QAAQ,EAAE,WAAW,EAAE,MAAM,CAAC,SAAS,EAAE,aAAa,EAAE,SAAS,EAAC,EAAE,EAAC;OAClG;KACF;IACD,IAAI,KAAI;IACR,KAAK,MAAK;IACV,KAAK,KAAI;;;IAGT,SAAS,MAAM,EAAE,SAAS,EAAE,aAAa,EAAE,SAAS,EAAE;;MAEpD,IAAI,SAAS,KAAK,IAAI,EAAE;QACtB,KAAK,GAAG,MAAK;OACd,MAAM;QACL,IAAI,CAAC,GAAG,MAAK;QACb,KAAK,GAAG,KAAI;QACZ,IAAI,GAAG,EAAC;OACT;MACD,IAAI,GAAG,UAAS;MAChB,YAAY,CAAC,KAAK,EAAC;MACnB,KAAK,GAAG,UAAU,CAAC,YAAY;QAC7B,WAAW,CAAC,SAAS,EAAE,aAAa,EAAC;OACtC,EAAE,SAAS,EAAC;MACb,OAAO,KAAK;KACb;;;IAGD,SAAS,aAAa,EAAE,SAAS,EAAE,SAAc,EAAE;2CAAP,GAAG;;MAC7C,IAAI,SAAS,GAAG,SAAS,IAAI,IAAG;;MAEhC,IAAI,aAAa,GAAG,SAAS,CAAC,aAAa,IAAI,EAAC;;MAEhD,IAAI,SAAS,GAAG,SAAS,CAAC,KAAK,IAAI,EAAC;;MAEpC,IAAI,OAAO,GAAG,SAAS,GAAG,SAAS,GAAG,SAAQ;MAC9C,OAAO,CAAC,gBAAgB,CAAC,QAAQ,EAAE,WAAW,EAAE,MAAM,CAAC,SAAS,EAAE,aAAa,EAAE,SAAS,EAAC,EAAE,GAAG,KAAK,EAAC;MACtG,MAAM,CAAC,SAAS,EAAE,aAAa,EAAE,SAAS,EAAC;MAC3C,YAAY,CAAC,IAAI,EAAC;KACnB;;;;;;;;;;;;"}